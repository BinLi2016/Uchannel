---
description: Autonomously convert a rebar detail image to an AutoCAD drawing using P-CAD.
---

This workflow automates the conversion of rebar detail images into AutoCAD drawings.

1.  **Ask for Image Path**
    - Ask the user for the absolute path of the rebar detail image (e.g., `h:\U形槽配筋软件\DrawingShot\钢筋大样-2.png`).

2.  **Generate P-CAD Code**
    - Use the `image-to-pcad` skill (read `h:\U形槽配筋软件\.agent\skills\image-to-pcad\SKILL.md` for guidance).
    - Analyze the image and generate a `.pcad` file (e.g., `P-CAD-code/AutoGenerated.pcad`).
    - Ensure the generated code includes a `sheet` and appropriate `place` commands.

// turbo
3.  **Transpile to AutoLISP**
    - Run the transpiler command (output to `h:\automation_temp` to avoid path encoding issues):
      ```powershell
      python h:\U形槽配筋软件\Python\pcad_to_autolisp.py P-CAD-code\AutoGenerated.pcad h:\automation_temp\AutoGenerated.lsp
      ```

4.  **AutoCAD Automation**
    - Create a temporary script file `h:\automation_temp\load_and_render.scr` with the following content:
      ```
      (load "H:/automation_temp/AutoGenerated.lsp")
      (c:PCAD_Render)
      (command "._ZOOM" "_ALL")
      ```
    - Search for `acad.exe` if not already known.
    // turbo
    - Execute AutoCAD with the script:
      ```powershell
      & "C:\Program Files\Autodesk\AutoCAD 2021\acad.exe" /b "H:\automation_temp\load_and_render.scr"
      ```
    - *Note: If acad.exe is in a different location, update the path accordingly.*

5.  **Verify Results**
    - Ask the user to confirm that AutoCAD opened and the drawing was generated correctly.
